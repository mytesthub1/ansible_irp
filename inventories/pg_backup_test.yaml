---
all:
  vars:
    postgres_s3_access_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          64623432333163306264313637333637306332663136343265616332653737376530646563653862
          3135393234326130653666326439346265343136643933350a646234643035333136653466333136
          65323434326562663561353465303033313431613538633232313031376633633864323637326637
          6539323333346564350a363462626636613131626161333939653161363761323239383166396436
          65373066656230333133663364336230616639353766636361363539316263663934616539356532
          6466633839363463366430623033343066616439343635313830
    postgres_s3_secret_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33656630373435373132633732653236356531306635306633303331336636666362373132333564
          3839333035656133343764373062616633333765343537310a623765393034656533353636623730
          32303665346262666136323663633631643330393065343134326538346466356663643835313834
          3061386131663265640a303635643834363738626431613537313466356430386564343562313439
          66613839316462393233393133383137336337313765383535626366653637663534626665356338
          3932363061353566343332326139386338313439396439653938
    postgres_s3_endpoint: https://storage.files.nl01.cloud.servers.com
    postgres_s3_restore_endpoint: https://storage.files.nl01.cloud.servers.com:8080
    postgres_storage_size: 150Gi
    postgres_instances: 1
    postgres_storage_class: openebs-lvmpv

    postgres_db_name: taco
    postgres_db_username: irp
    postgres_db_password: !vault |
              $ANSIBLE_VAULT;1.1;AES256
              63613338633661343932346439376631666638336266386130613432363931303231666231356266
              6234656230343038383562623563613739663938653265330a363061653366383462356562656166
              62613663396662353831306437366133323664346639303765663638373834613461313436323230
              3139373030343236320a646562633737313665386131363331313930326262663634353235323132
              37386630353332616662653230383031363266343831636438346261343566383433

    postgres_bootstrap_config:
      recovery:
        database: "{{ postgres_db_name }}"
        owner: "{{ postgres_db_username }}"
        secret:
          name: postgres-irp-user
        source: clusterBackup

    postgres_external_clusters:
      - name: clusterBackup
        barmanObjectStore:
          serverName: postgres-cluster
          destinationPath: s3://postgres-backups-prod/
          endpointURL: "{{ postgres_s3_restore_endpoint }}"
          s3Credentials:
            accessKeyId:
              name: backups-s3-creds
              key: access_key
            secretAccessKey:
              name: backups-s3-creds
              key: secret_key
          wal:
            maxParallel: 8

    postgres_barman_object_store: "{{ omit }}"
